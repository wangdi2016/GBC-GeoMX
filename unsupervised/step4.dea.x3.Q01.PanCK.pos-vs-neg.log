[1] "/Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library"
Loading required package: easyalluvial
Loading required package: plyr
Loading required package: dplyr

Attaching package: ‘dplyr’

The following objects are masked from ‘package:plyr’:

    arrange, count, desc, failwith, id, mutate, rename, summarise,
    summarize

The following objects are masked from ‘package:stats’:

    filter, lag

The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union

Loading required package: tibble
Loading required package: gridExtra

Attaching package: ‘gridExtra’

The following object is masked from ‘package:dplyr’:

    combine

Loading required package: FactoMineR
Loading required package: EnvStats

Attaching package: ‘EnvStats’

The following objects are masked from ‘package:stats’:

    predict, predict.lm

The following object is masked from ‘package:base’:

    print.default

Loading required package: ggrepel
Loading required package: ggplot2
Loading required package: parcats
Loading required package: pheatmap
Loading required package: plotly

Attaching package: ‘plotly’

The following object is masked from ‘package:ggplot2’:

    last_plot

The following objects are masked from ‘package:plyr’:

    arrange, mutate, rename, summarise

The following object is masked from ‘package:stats’:

    filter

The following object is masked from ‘package:graphics’:

    layout

Loading required package: scales
Loading required package: lme4
Loading required package: Matrix
Loading required package: ggthemes
Loading required package: GLMMadaptive

Attaching package: ‘GLMMadaptive’

The following object is masked from ‘package:lme4’:

    negative.binomial

The following object is masked from ‘package:EnvStats’:

    predict

Loading required package: MCMCglmm
Loading required package: coda
Loading required package: ape

Attaching package: ‘ape’

The following object is masked from ‘package:dplyr’:

    where

Loading required package: GGally
Loading required package: ggallin
Loading required package: stringi
Loading required package: parallel
Loading required package: openxlsx
Loading required package: lubridate

Attaching package: ‘lubridate’

The following objects are masked from ‘package:base’:

    date, intersect, setdiff, union

Loading required package: ggforce
Loading required package: tidyr

Attaching package: ‘tidyr’

The following objects are masked from ‘package:Matrix’:

    expand, pack, unpack

Loading required package: RColorBrewer
Loading required package: viridis
Loading required package: viridisLite

Attaching package: ‘viridis’

The following object is masked from ‘package:scales’:

    viridis_pal

Loading required package: DT
Loading required package: ComplexHeatmap
Loading required package: grid
========================================
ComplexHeatmap version 2.22.0
Bioconductor page: http://bioconductor.org/packages/ComplexHeatmap/
Github page: https://github.com/jokergoo/ComplexHeatmap
Documentation: http://jokergoo.github.io/ComplexHeatmap-reference

If you use it in published research, please cite either one:
- Gu, Z. Complex Heatmap Visualization. iMeta 2022.
- Gu, Z. Complex heatmaps reveal patterns and correlations in multidimensional 
    genomic data. Bioinformatics 2016.


The new InteractiveComplexHeatmap package can directly export static 
complex heatmaps into an interactive Shiny app with zero effort. Have a try!

This message can be suppressed by:
  suppressPackageStartupMessages(library(ComplexHeatmap))
========================================
! pheatmap() has been masked by ComplexHeatmap::pheatmap(). Most of the arguments
   in the original pheatmap() are identically supported in the new function. You 
   can still use the original function by explicitly calling pheatmap::pheatmap().


Attaching package: ‘ComplexHeatmap’

The following object is masked from ‘package:plotly’:

    add_heatmap

The following object is masked from ‘package:pheatmap’:

    pheatmap

Loading required package: GeomxTools
Loading required package: Biobase
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:lubridate’:

    intersect, setdiff, union

The following object is masked from ‘package:MCMCglmm’:

    path

The following object is masked from ‘package:gridExtra’:

    combine

The following objects are masked from ‘package:dplyr’:

    combine, intersect, setdiff, union

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    anyDuplicated, aperm, append, as.data.frame, basename, cbind,
    colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,
    get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply,
    match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,
    Position, rank, rbind, Reduce, rownames, sapply, saveRDS, setdiff,
    table, tapply, union, unique, unsplit, which.max, which.min

Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.

Loading required package: NanoStringNCTools
Loading required package: S4Vectors
Loading required package: stats4

Attaching package: ‘S4Vectors’

The following object is masked from ‘package:tidyr’:

    expand

The following objects are masked from ‘package:lubridate’:

    second, second<-

The following objects are masked from ‘package:Matrix’:

    expand, unname

The following object is masked from ‘package:plotly’:

    rename

The following objects are masked from ‘package:dplyr’:

    first, rename

The following object is masked from ‘package:plyr’:

    rename

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    expand.grid, I, unname


Attaching package: ‘NanoStringNCTools’

The following object is masked from ‘package:plotly’:

    groups

The following object is masked from ‘package:dplyr’:

    groups

Loading required package: circlize
========================================
circlize version 0.4.16
CRAN page: https://cran.r-project.org/package=circlize
Github page: https://github.com/jokergoo/circlize
Documentation: https://jokergoo.github.io/circlize_book/book/

If you use it in published research, please cite:
Gu, Z. circlize implements and enhances circular visualization
  in R. Bioinformatics 2014.

This message can be suppressed by:
  suppressPackageStartupMessages(library(circlize))
========================================


Attaching package: ‘circlize’

The following object is masked from ‘package:ape’:

    degree

Warning messages:
1: In dir.create(outdir, recursive = TRUE) :
  'output_GBC_20250904' already exists
2: In dir.create(fig_dir, recursive = TRUE) :
  'output_GBC_20250904/figures' already exists
3: In dir.create(de_dir, recursive = TRUE) :
  'output_GBC_20250904/de_dir' already exists
4: In dir.create(object_dir, recursive = TRUE) :
  'output_GBC_20250904/R_objects' already exists
5: In dir.create(outdata_dir, recursive = TRUE) :
  'output_GBC_20250904/data' already exists
==========================================
== Question  1:** PanCK+ vs PanCK- AOIs ==
==========================================
== PanCK+ vs PanCK- ==
NULL
Removed 0 samples/AOIs.
<table>
 <thead>
  <tr>
   <th style="text-align:left;"> PanCK </th>
   <th style="text-align:right;"> nPatients </th>
   <th style="text-align:right;"> nAOIs </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> negative </td>
   <td style="text-align:right;"> 56 </td>
   <td style="text-align:right;"> 501 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> positive </td>
   <td style="text-align:right;"> 57 </td>
   <td style="text-align:right;"> 504 </td>
  </tr>
</tbody>
</table>
Warning message:
In dir.create(out_dir, recursive = TRUE) :
  'output_GBC_20250904/de_dir' already exists
null device 
          1 
null device 
          1 
# A tibble: 6 × 3
  CancerType Protein Expression
  <chr>      <chr>        <dbl>
1 CC         CD20         184. 
2 CC         CD8          526. 
3 CC         HLA-DR       672. 
4 CC         SMA       117474. 
5 CC         CTLA4         26.3
6 CC         CD11c        471. 
# A tibble: 6 × 6
  Protein term          estimate std.error statistic  p.value
  <chr>   <chr>            <dbl>     <dbl>     <dbl>    <dbl>
1 4-1BB   (Intercept)     19.2        1.50    12.8   1.00e-34
2 4-1BB   CancerTypeIM     0.989      2.34     0.422 6.73e- 1
3 4-1BB   CancerTypeLGD    3.18       2.12     1.50  1.33e- 1
4 4-1BB   CancerTypeHGD   -2.05       1.98    -1.04  3.00e- 1
5 4-1BB   CancerTypeIC     7.09       2.10     3.38  7.62e- 4
6 ARG1    (Intercept)     61.5        6.46     9.51  1.38e-20
`geom_smooth()` using formula = 'y ~ x'
There were 50 or more warnings (use warnings() to see the first 50)
`geom_smooth()` using formula = 'y ~ x'
There were 50 or more warnings (use warnings() to see the first 50)
`geom_smooth()` using formula = 'y ~ x'
There were 50 or more warnings (use warnings() to see the first 50)
`geom_smooth()` using formula = 'y ~ x'
There were 50 or more warnings (use warnings() to see the first 50)
`geom_smooth()` using formula = 'y ~ x'
There were 50 or more warnings (use warnings() to see the first 50)
`geom_smooth()` using formula = 'y ~ x'
There were 50 or more warnings (use warnings() to see the first 50)
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
There were 50 or more warnings (use warnings() to see the first 50)
pdf 
  2 
`geom_smooth()` using formula = 'y ~ x'
Warning message:
The following aesthetics were dropped during statistical transformation: fill.
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor? 
`geom_smooth()` using formula = 'y ~ x'
Warning message:
The following aesthetics were dropped during statistical transformation: fill.
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor? 
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
There were 50 or more warnings (use warnings() to see the first 50)
pdf 
  2 
R version 4.4.2 (2024-10-31)
Platform: aarch64-apple-darwin20
Running under: macOS Sequoia 15.6.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/New_York
tzcode source: internal

attached base packages:
 [1] stats4    grid      parallel  stats     graphics  grDevices utils    
 [8] datasets  methods   base     

other attached packages:
 [1] broom_1.0.9              circlize_0.4.16          GeomxTools_3.10.0       
 [4] NanoStringNCTools_1.14.0 S4Vectors_0.44.0         Biobase_2.66.0          
 [7] BiocGenerics_0.52.0      ComplexHeatmap_2.22.0    DT_0.33                 
[10] viridis_0.6.5            viridisLite_0.4.2        RColorBrewer_1.1-3      
[13] tidyr_1.3.1              ggforce_0.5.0            lubridate_1.9.4         
[16] openxlsx_4.2.8           stringi_1.8.7            ggallin_0.1.1           
[19] GGally_2.3.0             MCMCglmm_2.36            ape_5.8-1               
[22] coda_0.19-4.1            GLMMadaptive_0.9-7       ggthemes_5.1.0          
[25] lme4_1.1-37              Matrix_1.7-3             scales_1.4.0            
[28] plotly_4.11.0            pheatmap_1.0.13          parcats_0.0.5           
[31] ggrepel_0.9.6            ggplot2_3.5.2            EnvStats_3.1.0          
[34] FactoMineR_2.12          gridExtra_2.3            tibble_3.3.0            
[37] dplyr_1.1.4              plyr_1.8.9               easyalluvial_0.3.2      

loaded via a namespace (and not attached):
  [1] cubature_2.1.4          splines_4.4.2           cellranger_1.1.0       
  [4] polyclip_1.10-7         hardhat_1.4.1           rpart_4.1.24           
  [7] lifecycle_1.0.4         Rdpack_2.6.4            doParallel_1.0.17      
 [10] globals_0.18.0          lattice_0.22-7          MASS_7.3-65            
 [13] crosstalk_1.2.1         flashClust_1.01-2       backports_1.5.0        
 [16] magrittr_2.0.3          sass_0.4.10             yaml_2.3.10            
 [19] jquerylib_0.1.4         spam_2.11-1             zip_2.3.3              
 [22] sp_2.2-0                minqa_1.2.8             zlibbioc_1.52.0        
 [25] purrr_1.1.0             nnet_7.3-20             tensorA_0.36.2.1       
 [28] tweenr_2.0.3            ipred_0.9-15            lava_1.8.1             
 [31] GenomeInfoDbData_1.2.13 IRanges_2.40.1          listenv_0.9.1          
 [34] parallelly_1.45.1       svglite_2.2.1           codetools_0.2-20       
 [37] tidyselect_1.2.1        shape_1.4.6.1           UCSC.utils_1.2.0       
 [40] farver_2.1.2            matrixStats_1.5.0       jsonlite_2.0.0         
 [43] GetoptLong_1.0.5        progressr_0.15.1        ggridges_0.5.6         
 [46] ggalluvial_0.12.5       survival_3.8-3          iterators_1.0.14       
 [49] emmeans_1.11.2          systemfonts_1.2.3       foreach_1.5.2          
 [52] tools_4.4.2             ragg_1.4.0              Rcpp_1.1.0             
 [55] glue_1.8.0              prodlim_2025.04.28      mgcv_1.9-3             
 [58] xfun_0.52               GenomeInfoDb_1.42.3     withr_3.0.2            
 [61] numDeriv_2016.8-1.1     fastmap_1.2.0           boot_1.3-31            
 [64] digest_0.6.37           timechange_0.3.0        R6_2.6.1               
 [67] estimability_1.5.1      ggprism_1.0.6           textshaping_1.0.1      
 [70] colorspace_2.1-1        dichromat_2.0-0.1       utf8_1.2.6             
 [73] generics_0.1.4          data.table_1.17.8       recipes_1.3.1          
 [76] corpcor_1.6.10          class_7.3-23            httr_1.4.7             
 [79] htmlwidgets_1.6.4       scatterplot3d_0.3-44    ggstats_0.10.0         
 [82] pkgconfig_2.0.3         gtable_0.3.6            timeDate_4041.110      
 [85] S7_0.2.0                XVector_0.46.0          htmltools_0.5.8.1      
 [88] dotCall64_1.2           multcompView_0.1-10     clue_0.3-66            
 [91] SeuratObject_5.1.0      leaps_3.2               png_0.1-8              
 [94] gower_1.0.2             reformulas_0.4.1        knitr_1.50             
 [97] reshape2_1.4.4          rjson_0.2.23            uuid_1.2-1             
[100] nlme_3.1-168            nloptr_2.2.1            cachem_1.1.0           
[103] GlobalOptions_0.1.2     stringr_1.5.1           vipor_0.4.7            
[106] pillar_1.11.0           vctrs_0.6.5             xtable_1.8-4           
[109] cluster_2.1.8.1         beeswarm_0.4.0          evaluate_1.0.4         
[112] magick_2.8.7            mvtnorm_1.3-3           cli_3.6.5              
[115] compiler_4.4.2          rlang_1.1.6             crayon_1.5.3           
[118] future.apply_1.20.0     labeling_0.4.3          forcats_1.0.0          
[121] ggbeeswarm_0.7.2        ggiraph_0.8.13          lmerTest_3.1-3         
[124] Biostrings_2.74.1       lazyeval_0.2.2          future_1.67.0          
[127] rbibutils_2.3           bslib_0.9.0             readxl_1.4.5           
